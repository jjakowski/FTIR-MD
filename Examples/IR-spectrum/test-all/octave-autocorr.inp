

#

  printf("# Check  if the number or atoms is crrect ! \n"); 
  Natoms=5  
  Nat = Natoms; 

  V=load("tmp") ;

  N1=size(V,1) ; N2=size(V,2) ;
  Nt=N1/Natoms ;
  Nxyz= N1*N2/Nt  

  #   each row represents time, each column  is different xyz
  VV= transpose( reshape(transpose(V), Nxyz,Nt) )   ; 


Vacf=zeros(Nt,Nxyz)  ;


printf("# ACF : \n")

for ii=0:Nt-1     #shift
   #Vac(1+ii,:)=   sum(sum( VV(1:Nt-ii,:) .* VV(1+ii:Nt,:),1),2) *   3/(Nt*Nxyz)  ;
   Vacf(1+ii,:)=   sum( VV(1:Nt-ii,:) .* VV(1+ii:Nt,:),1)  / Nt   ;   # averaged over time   (1/Nt) 
   printf("   %18.10e   \n", sum(Vacf(1+ii,:),2 )/Nat   )         ;   # averaged over atoms  (1/Nat)
endfor





