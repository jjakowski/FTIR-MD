
# autocorreltion function (ACF)
# 


#- first get a velocity file:

    cat   ../movie.xyz   | sed -n "/MD/,+2 p"  | grep  H  |   cut -b70-  > vel-H1.dat 
    cp vel-H1.dat  tmp
    octave  <  octave-autocorr.inp >  octave-autocorr.out



#-- now   calcualte  ACF

 dt=0.5 
  cat  octave-autocorr.out   | sed -n "/ACF/,$ p"  | grep -v "#" | awk  -v dt=$dt  '{au2fs=0.02418884326505; time=(NR-1)*dt/au2fs; if(NF!=0) printf(" %20.10f   %s  \n",time, $1 )}'   | tail -n +1  >  acf-x.dat
  cat  octave-autocorr.out   | sed -n "/ACF/,$ p"  | grep -v "#" | awk  -v dt=$dt  '{au2fs=0.02418884326505; time=(NR-1)*dt/au2fs; if(NF!=0) printf(" %20.10f   %s  \n",time, $2 )}'   | tail -n +1  >  acf-y.dat
  cat  octave-autocorr.out   | sed -n "/ACF/,$ p"  | grep -v "#" | awk  -v dt=$dt  '{au2fs=0.02418884326505; time=(NR-1)*dt/au2fs; if(NF!=0) printf(" %20.10f   %s  \n",time, $3 )}'   | tail -n +1  >  acf-z.dat

  cat vel-H1.dat   |  grep -v "#" | awk  -v dt=$dt  '{au2fs=0.02418884326505; time=(NR-1)*dt/au2fs; if(NF!=0) printf(" %20.10f   %s  \n",time, $1 )}'   | tail -n +1  >  vx.dat
  cat vel-H1.dat   |  grep -v "#" | awk  -v dt=$dt  '{au2fs=0.02418884326505; time=(NR-1)*dt/au2fs; if(NF!=0) printf(" %20.10f   %s  \n",time, $2 )}'   | tail -n +1  >  vy.dat
  cat vel-H1.dat   |  grep -v "#" | awk  -v dt=$dt  '{au2fs=0.02418884326505; time=(NR-1)*dt/au2fs; if(NF!=0) printf(" %20.10f   %s  \n",time, $3 )}'   | tail -n +1  >  vz.dat



#-- now FFT of ACF
 octave   ./octave-fft1d.m    acf-x.dat  |tail -n+1 |sed -n "/period =/,$ p"  > w-acfx.dat
 octave   ./octave-fft1d.m    acf-y.dat  |tail -n+1 |sed -n "/period =/,$ p"  > w-acfy.dat
 octave   ./octave-fft1d.m    acf-z.dat  |tail -n+1 |sed -n "/period =/,$ p"  > w-acfz.dat

 octave   ./octave-fft1d.m    vx.dat  |tail -n+1 |sed -n "/period =/,$ p"  > w-vx.dat
 octave   ./octave-fft1d.m    vy.dat  |tail -n+1 |sed -n "/period =/,$ p"  > w-vy.dat
 octave   ./octave-fft1d.m    vz.dat  |tail -n+1 |sed -n "/period =/,$ p"  > w-vz.dat


#  
tail -n+2 w-xdQ.dat  |  ./rotate_fft.py   >  w2-xdQ.dat 


paste w-acfx2.dat  w-acfy2.dat  w-acfz2.dat   >  w-acf-all2.dat


gnuplot gnuscript-freqs


   out-freqs-x_cm.pdf     # <-- single H and only FFT of  "x" is shown
   out-freqs-xyz_cm.pdf   # <--- single H aand all (xyz) of ACF is shown
